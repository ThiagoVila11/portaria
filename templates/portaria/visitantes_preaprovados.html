{% extends "base.html" %}
{% block title %}Visitantes Pré-Aprovados · Portaria{% endblock %}
{% block page_title %}Visitantes Pré-Aprovados{% endblock %}

{% block content %}
<div class="card" style="padding:16px">

  <form method="get" style="display:flex; gap:10px; margin-bottom:12px">
    <label style="display:grid; gap:6px">
      <span>Condomínio</span>
      <select name="condominio">
        <option value="">Todos</option>
        {% for c in condominios %}
          <option value="{{ c.id }}" {% if request.GET.condominio == c.id|stringformat:"s" %}selected{% endif %}>
            {{ c.nome }}
          </option>
        {% endfor %}
      </select>
    </label>
    <div style="align-self:end">
      <button class="btn" type="submit">Filtrar</button>
      <a class="btn-outline" href="{% url 'visitantes_preaprovados' %}">Limpar</a>
    </div>
  </form>


  <p class="muted">Total: <strong>{{ total }}</strong></p>
  <table border="1" cellpadding="6" width="100%">
    <tr>
      <th>Nome</th>
      <th>Fone</th>
      <th>Unidade</th>
      <th>Morador</th>
      <th>Data Criação</th>
      <th>Permitido até</th>

    </tr>
    {% for v in visitantes %}
    <tr>
      <td>{{ v.reda__Guest_Name__c }}</td>
      <td>{{ v.reda__Guest_Phone__c }}</td>
      <td>{{ v.reda__Property__r.Name }}</td>
      <td>{{ v.reda__Contact__r.Name }}</td>
      <td>{{ v.CreatedDate }}</td>
      <td>{{ v.reda__Permitted_Till_Datetime__c}}</td>
      
    </tr>
    {% empty %}
    <tr><td colspan="6">Nenhum visitante pré-aprovado encontrado.</td></tr>
    {% endfor %}
  </table>
</div>
{% endblock %}

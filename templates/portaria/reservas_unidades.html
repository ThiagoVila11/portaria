{% extends "base.html" %}
{% block title %}Reservas · Portaria{% endblock %}
{% block page_title %}Reservas - Recepção{% endblock %}

{% block content %}
<h3 style="color:red">TEMPLATE ATIVO: /opt/port/portaria/templates/portaria/reservas_unidades.html</h3>

<div class="card" style="padding:16px; overflow-x:auto;">

  <form method="get" style="display:flex; gap:10px; margin-bottom:12px; flex-wrap: wrap;">
    <label style="display:grid; gap:6px">
      <span>Condomínio</span>
      <select name="condominio">
        <option value="">Todos</option>
        {% for c in condominios %}
          <option value="{{ c.id }}" {% if condominio_pk == c.id|stringformat:"s" %}selected{% endif %}>
            {{ c.nome }}
          </option>
        {% endfor %}
      </select>
    </label>

    <label style="display:grid; gap:6px">
      <span>Data início</span>
      <input type="date" name="data_inicio" value="{{ data_inicio|default:'' }}">
    </label>

    <label style="display:grid; gap:6px">
      <span>Data fim</span>
      <input type="date" name="data_fim" value="{{ data_fim|default:'' }}">
    </label>

    <div style="align-self:end">
      <button class="btn" type="submit">Filtrar</button>
      <a class="btn-outline" href="{% url 'reservas_unidades' %}">Limpar</a>
    </div>
  </form>

  <p class="muted">Total: <strong>{{ total }}</strong></p>

  <div style="overflow-x:auto;">
    <table border="1" cellpadding="6" width="100%" style="border-collapse: collapse; min-width: 1000px;">
      <thead>
        <tr>
          <th>ID</th>
          <th>Espaço</th>
          <th>Unidade</th>
          <th>Responsável</th>
          <th>Descrição</th>
          <th>Data Início</th>
          <th>Data Fim</th>
          <th>Valor</th>
          <th>Situação</th>
        </tr>
      </thead>
      <tbody>
        {% for v in reservas %}
        <tr>
          <td>{{ v.Id }}</td>
          <td>{{ v.reda__Property__r.Name }}</td>
          <td>{{ v.Opportunity_property__c }}</td>
          <td>{{ v.Contact__r.Name }}</td>
          <td>{{ v.reda__Description__c }}</td>
          <td>{{ v.reda__Start_Datetime__c}}</td>
          <td>{{ v.reda__End_Datetime__c}}</td>
          <td>{{ v.reda__Total_Booking_Amount__c }}</td>
          <td>{{ v.Status_PT }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="9">Nenhuma reserva encontrada.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>

{% endblock %}
